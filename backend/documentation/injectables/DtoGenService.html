<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>tunein-backend documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-md-none p-0">
               <div class="d-flex">
                    <a href="../" class="navbar-brand">tunein-backend documentation</a>
                    <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
               </div>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="d-none d-md-block menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">








<ol class="breadcrumb">
  <li class="breadcrumb-item">Injectables</li>
  <li class="breadcrumb-item" >DtoGenService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/modules/dto-gen/dto-gen.service.ts</code>
        </p>





            <section data-compodoc="block-index">
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#generateBriefUserProfileDto" >generateBriefUserProfileDto</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#generateMultipleRoomDto" >generateMultipleRoomDto</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#generateMultipleUserProfileDto" >generateMultipleUserProfileDto</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#generateRoomDto" >generateRoomDto</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#generateRoomDtoFromRoom" >generateRoomDtoFromRoom</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#generateUserDto" >generateUserDto</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#generateUserProfileDto" >generateUserProfileDto</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section data-compodoc="block-constructor">
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(prisma: <a href="../injectables/PrismaService.html" target="_self">PrismaService</a>, dbUtils: <a href="../injectables/DbUtilsService.html" target="_self">DbUtilsService</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="87" class="link-to-prism">src/modules/dto-gen/dto-gen.service.ts:87</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>prisma</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/PrismaService.html" target="_self" >PrismaService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>dbUtils</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/DbUtilsService.html" target="_self" >DbUtilsService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section data-compodoc="block-methods">
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="generateBriefUserProfileDto"></a>
                    <span class="name">
                        <span ><b>generateBriefUserProfileDto</b></span>
                        <a href="#generateBriefUserProfileDto"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>generateBriefUserProfileDto(user: Prisma.users)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="173"
                                    class="link-to-prism">src/modules/dto-gen/dto-gen.service.ts:173</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>user</td>
                                            <td>
                                                        <code>Prisma.users</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../classes/UserProfileDto.html" target="_self" >UserProfileDto</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="generateMultipleRoomDto"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>generateMultipleRoomDto</b></span>
                        <a href="#generateMultipleRoomDto"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>generateMultipleRoomDto(room_ids: string[])</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="354"
                                    class="link-to-prism">src/modules/dto-gen/dto-gen.service.ts:354</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>room_ids</td>
                                            <td>
                                                        <code>string[]</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;[] | null&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="generateMultipleUserProfileDto"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>generateMultipleUserProfileDto</b></span>
                        <a href="#generateMultipleUserProfileDto"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>generateMultipleUserProfileDto(user_ids: string[])</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="218"
                                    class="link-to-prism">src/modules/dto-gen/dto-gen.service.ts:218</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>user_ids</td>
                                            <td>
                                                        <code>string[]</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../classes/UserProfileDto.html" target="_self" >Promise&lt;UserProfileDto[]&gt;</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="generateRoomDto"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>generateRoomDto</b></span>
                        <a href="#generateRoomDto"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>generateRoomDto(roomID: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="242"
                                    class="link-to-prism">src/modules/dto-gen/dto-gen.service.ts:242</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>roomID</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../classes/RoomDto.html" target="_self" >Promise&lt;RoomDto | null&gt;</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="generateRoomDtoFromRoom"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>generateRoomDtoFromRoom</b></span>
                        <a href="#generateRoomDtoFromRoom"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>generateRoomDtoFromRoom(room: Prisma.room)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="300"
                                    class="link-to-prism">src/modules/dto-gen/dto-gen.service.ts:300</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>room</td>
                                            <td>
                                                        <code>Prisma.room</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../classes/RoomDto.html" target="_self" >Promise&lt;RoomDto | null&gt;</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="generateUserDto"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>generateUserDto</b></span>
                        <a href="#generateUserDto"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>generateUserDto()</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="420"
                                    class="link-to-prism">src/modules/dto-gen/dto-gen.service.ts:420</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../classes/UserDto.html" target="_self" >Promise&lt;UserDto | null&gt;</a></code>

                        </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="generateUserProfileDto"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>generateUserProfileDto</b></span>
                        <a href="#generateUserProfileDto"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>generateUserProfileDto(userID: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, fully_qualify: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank">boolean</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="93"
                                    class="link-to-prism">src/modules/dto-gen/dto-gen.service.ts:93</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                                <td>Default value</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>userID</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>

                                            <td>
                                            </td>

                                        </tr>
                                        <tr>
                                                <td>fully_qualify</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>

                                            <td>
                                                    <code>true</code>
                                            </td>

                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="../classes/UserProfileDto.html" target="_self" >Promise&lt;UserProfileDto | null&gt;</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable } from &quot;@nestjs/common&quot;;
import { UserProfileDto } from &quot;../profile/dto/userprofile.dto&quot;;
import { RoomDto } from &quot;../rooms/dto/room.dto&quot;;
import { UserDto } from &quot;../users/dto/user.dto&quot;;
import { PrismaService } from &quot;../../../prisma/prisma.service&quot;;
import * as Prisma from &quot;@prisma/client&quot;;
import { DbUtilsService } from &quot;../db-utils/db-utils.service&quot;;

/*
## UserProfileDto (User Profile Info)
A object representing User Profile information.
&#x60;&#x60;&#x60;json
{
	profile_name : string,
	userID : string,
	username : string,
	profile_picture_url : string,
	followers: {
		count: int,
		data: [ProfileDto]
	},
	following: {
		count: int,
		data: [ProfileDto]
	},
	links: {
		count: int,
		data: [string]
	},
	bio : string,
	current_song: SongInfoDto,
	fav_genres: {
		count: int,
		data: [string]
	},
	fav_songs: {
		count: int,
		data: [SongInfoDto]
	},
	fav_rooms: {
		count: int,
		data: [RoomDto]
	},
	recent_rooms: {
		count: int,
		data: [RoomDto]
	}
}
&#x60;&#x60;&#x60;

## RoomDto (Room Info)
A object representing Room information.
&#x60;&#x60;&#x60;json
{
	creator: ProfileDto,
	roomID: string,
	partipicant_count: number,
	room_name: string,
	description: string,
	is_temporary: boolean,
	is_private: boolean,
	is_scheduled: boolean,
	start_date: DateTime,
	end_date: DateTime,
	language: string,
	has_explicit_content: boolean,
	has_nsfw_content: boolean,
	room_image: string,
	current_song: SongInfoDto,
	tags: [string]
}
&#x60;&#x60;&#x60;

## SongInfoDto (Song Info)
A object representing Song information.
&#x60;&#x60;&#x60;json
{
	title: string,
	artists: [string],
	cover: string,
	start_time: DateTime
}
&#x60;&#x60;&#x60;
*/
// A service that will generate DTOs
@Injectable()
export class DtoGenService {
	constructor(
		private readonly prisma: PrismaService,
		private readonly dbUtils: DbUtilsService,
	) {}

	async generateUserProfileDto(
		userID: string,
		fully_qualify: boolean &#x3D; true,
	): Promise&lt;UserProfileDto | null&gt; {
		//check if userID exists
		const user: Prisma.users | null &#x3D; await this.prisma.users.findUnique({
			where: { user_id: userID },
		});

		if (!user || user &#x3D;&#x3D;&#x3D; null) {
			return null;
		}

		//get user info
		const result: UserProfileDto &#x3D; this.generateBriefUserProfileDto(user);

		const following: Prisma.users[] | null &#x3D;
			await this.dbUtils.getUserFollowing(userID);
		if (following &amp;&amp; following !&#x3D;&#x3D; null) {
			result.following.count &#x3D; following.length;
			if (fully_qualify) {
				for (let i &#x3D; 0; i &lt; following.length; i++) {
					const f &#x3D; following[i];
					if (f &amp;&amp; f !&#x3D;&#x3D; null) {
						const u: UserProfileDto &#x3D; this.generateBriefUserProfileDto(f);
						result.following.data.push(u);
					}
				}
			}
		}

		const followers: Prisma.users[] | null &#x3D;
			await this.dbUtils.getUserFollowers(userID);
		if (followers &amp;&amp; followers !&#x3D;&#x3D; null) {
			result.followers.count &#x3D; followers.length;
			if (fully_qualify) {
				for (let i &#x3D; 0; i &lt; followers.length; i++) {
					const f &#x3D; followers[i];
					if (f &amp;&amp; f !&#x3D;&#x3D; null) {
						const u: UserProfileDto &#x3D; this.generateBriefUserProfileDto(f);
						result.followers.data.push(u);
					}
				}
			}
		}

		//exclude links temporarily
		//exclude current songs
		//exclude fav genres
		//exclude fav songs

		if (fully_qualify) {
			const favRooms: Prisma.room[] | null &#x3D;
				await this.dbUtils.getRandomRooms(5);
			if (favRooms &amp;&amp; favRooms !&#x3D;&#x3D; null) {
				result.fav_rooms.count &#x3D; favRooms.length;
				const ids: string[] &#x3D; favRooms.map((r) &#x3D;&gt; r.room_id);
				const rooms &#x3D; await this.generateMultipleRoomDto(ids);
				if (rooms &amp;&amp; rooms !&#x3D;&#x3D; null) {
					result.fav_rooms.data &#x3D; rooms;
				}
			}
		}

		if (fully_qualify) {
			const recentRooms: Prisma.room[] | null &#x3D;
				await this.dbUtils.getRandomRooms(5);
			if (recentRooms &amp;&amp; recentRooms !&#x3D;&#x3D; null) {
				result.recent_rooms.count &#x3D; recentRooms.length;
				const ids: string[] &#x3D; recentRooms.map((r) &#x3D;&gt; r.room_id);
				const rooms &#x3D; await this.generateMultipleRoomDto(ids);
				if (rooms &amp;&amp; rooms !&#x3D;&#x3D; null) {
					result.recent_rooms.data &#x3D; rooms;
				}
			}
		}

		return result;
	}

	generateBriefUserProfileDto(user: Prisma.users): UserProfileDto {
		const result: UserProfileDto &#x3D; {
			profile_name: user.full_name || &quot;&quot;,
			userID: user.user_id,
			username: user.username,
			profile_picture_url: user.profile_picture || &quot;&quot;,
			followers: {
				count: 0,
				data: [],
			},
			following: {
				count: 0,
				data: [],
			},
			links: {
				count: 0,
				data: [],
			},
			bio: user.bio || &quot;&quot;,
			current_song: {
				title: &quot;&quot;,
				artists: [],
				cover: &quot;&quot;,
				start_time: new Date(),
			},
			fav_genres: {
				count: 0,
				data: [],
			},
			fav_songs: {
				count: 0,
				data: [],
			},
			fav_rooms: {
				count: 0,
				data: [],
			},
			recent_rooms: {
				count: 0,
				data: [],
			},
		};
		return result;
	}

	async generateMultipleUserProfileDto(
		user_ids: string[],
	): Promise&lt;UserProfileDto[]&gt; {
		const users: Prisma.users[] | null &#x3D; await this.prisma.users.findMany({
			where: { user_id: { in: user_ids } },
		});

		if (!users || users &#x3D;&#x3D;&#x3D; null) {
			return [];
		}

		const result: UserProfileDto[] &#x3D; [];
		for (let i &#x3D; 0; i &lt; users.length; i++) {
			const u &#x3D; users[i];
			if (u &amp;&amp; u !&#x3D;&#x3D; null) {
				const user &#x3D; await this.generateUserProfileDto(u.user_id, false);
				if (user &amp;&amp; user !&#x3D;&#x3D; null) {
					result.push(user);
				}
			}
		}
		return result;
	}

	async generateRoomDto(roomID: string): Promise&lt;RoomDto | null&gt; {
		const room: Prisma.room | null &#x3D; await this.prisma.room.findUnique({
			where: { room_id: roomID },
		});

		if (!room || room &#x3D;&#x3D;&#x3D; null) {
			return null;
		}

		const scheduledRoom &#x3D; await this.prisma.scheduled_room.findUnique({
			where: { room_id: roomID },
		});

		const result: RoomDto &#x3D; {
			creator: new UserProfileDto(),
			roomID: room.room_id,
			participant_count: 0,
			room_name: room.name,
			description: room.description || &quot;&quot;,
			is_temporary: room.is_temporary || false,
			is_private: await this.dbUtils.isRoomPrivate(roomID),
			is_scheduled: false,
			start_date: new Date(),
			end_date: new Date(),
			language: room.room_language || &quot;&quot;,
			has_explicit_content: room.explicit || false,
			has_nsfw_content: room.nsfw || false,
			room_image: room.playlist_photo || &quot;&quot;,
			current_song: {
				title: &quot;&quot;,
				artists: [],
				cover: &quot;&quot;,
				start_time: new Date(),
			},
			tags: room.tags || [],
		};

		if (scheduledRoom &amp;&amp; scheduledRoom !&#x3D;&#x3D; null) {
			result.is_scheduled &#x3D; true;
			/*
			result.start_date &#x3D; scheduledRoom.start_date;
			result.end_date &#x3D; scheduledRoom.end_date;
			*/
		}

		const creator &#x3D; await this.generateUserProfileDto(room.room_creator, false);
		if (creator &amp;&amp; creator !&#x3D;&#x3D; null) {
			result.creator &#x3D; creator;
		}

		//participant count will be added later
		//current song will be added later
		//dates will be added later
		//current songs will be added later

		return result;
	}

	async generateRoomDtoFromRoom(room: Prisma.room): Promise&lt;RoomDto | null&gt; {
		if (!room || room &#x3D;&#x3D;&#x3D; null) {
			return null;
		}

		const scheduledRoom &#x3D; await this.prisma.scheduled_room.findUnique({
			where: { room_id: room.room_id },
		});

		const result: RoomDto &#x3D; {
			creator: new UserProfileDto(),
			roomID: room.room_id,
			participant_count: 0,
			room_name: room.name,
			description: room.description || &quot;&quot;,
			is_temporary: room.is_temporary || false,
			is_private: await this.dbUtils.isRoomPrivate(room.room_id),
			is_scheduled: false,
			start_date: new Date(),
			end_date: new Date(),
			language: room.room_language || &quot;&quot;,
			has_explicit_content: room.explicit || false,
			has_nsfw_content: room.nsfw || false,
			room_image: room.playlist_photo || &quot;&quot;,
			current_song: {
				title: &quot;&quot;,
				artists: [],
				cover: &quot;&quot;,
				start_time: new Date(),
			},
			tags: room.tags || [],
		};

		const creator &#x3D; await this.generateUserProfileDto(room.room_creator, false);
		if (creator &amp;&amp; creator !&#x3D;&#x3D; null) {
			result.creator &#x3D; creator;
		}

		if (scheduledRoom &amp;&amp; scheduledRoom !&#x3D;&#x3D; null) {
			result.is_scheduled &#x3D; true;
			/*
			result.start_date &#x3D; scheduledRoom.start_date;
			result.end_date &#x3D; scheduledRoom.end_date;
			*/
		}

		//participant count will be added later
		//current song will be added later
		//dates will be added later
		//current songs will be added later

		return result;
	}

	async generateMultipleRoomDto(room_ids: string[]): Promise&lt;RoomDto[] | null&gt; {
		const rooms: Prisma.room[] | null &#x3D; await this.prisma.room.findMany({
			where: { room_id: { in: room_ids } },
		});

		if (!rooms || rooms &#x3D;&#x3D;&#x3D; null) {
			return null;
		}

		const userIds: string[] &#x3D; rooms.map((r) &#x3D;&gt; r.room_creator);
		//remove duplicate user ids
		const uniqueUserIds: string[] &#x3D; [...new Set(userIds)];
		const users: Prisma.users[] | null &#x3D; await this.prisma.users.findMany({
			where: { user_id: { in: uniqueUserIds } },
		});

		const userProfiles: UserProfileDto[] &#x3D; [];
		for (let i &#x3D; 0; i &lt; users.length; i++) {
			const u &#x3D; users[i];
			if (u &amp;&amp; u !&#x3D;&#x3D; null) {
				const user &#x3D; this.generateBriefUserProfileDto(u);
				userProfiles.push(user);
			}
		}

		const result: RoomDto[] &#x3D; [];
		for (let i &#x3D; 0; i &lt; rooms.length; i++) {
			const r &#x3D; rooms[i];
			if (r &amp;&amp; r !&#x3D;&#x3D; null) {
				const u &#x3D; userProfiles.find((u) &#x3D;&gt; u.userID &#x3D;&#x3D;&#x3D; r.room_creator);
				if (!u || u &#x3D;&#x3D;&#x3D; null) {
					throw new Error(
						&quot;Weird error. Got users from Rooms table but user (&quot; +
							r.room_creator +
							&quot;) not found in Users table&quot;,
					);
				}
				const room: RoomDto &#x3D; {
					creator: u || new UserProfileDto(),
					roomID: r.room_id,
					participant_count: 0, //to fix soon
					room_name: r.name,
					description: r.description || &quot;&quot;,
					is_temporary: r.is_temporary || false,
					is_private: false, //db must add column
					is_scheduled: false, //db must add column
					start_date: new Date(),
					end_date: new Date(),
					language: r.room_language || &quot;&quot;,
					has_explicit_content: r.explicit || false,
					has_nsfw_content: r.nsfw || false,
					room_image: r.playlist_photo || &quot;&quot;,
					current_song: {
						title: &quot;&quot;,
						artists: [],
						cover: &quot;&quot;,
						start_time: new Date(),
					},
					tags: r.tags || [],
				};
				result.push(room);
			}
		}
		return result;
	}

	async generateUserDto(): Promise&lt;UserDto | null&gt; {
		return new UserDto();
	}
}
</code></pre>
    </div>

</div>













                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'DtoGenService.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script>
               $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               checkToggle(darkModeState);
               if ($darkModeToggleSwitchers.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
