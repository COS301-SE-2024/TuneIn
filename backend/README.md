# Nest
<p align="center">
<a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="200" alt="Nest Logo" /></a>
</p>
<p align="center">A progressive <a href="http://nodejs.org" target="_blank">Node.js</a> framework for building efficient and scalable server-side applications.</p>

<a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/v/@nestjs/core.svg" alt="NPM Version" /></a>
<a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/l/@nestjs/core.svg" alt="Package License" /></a>
<a href="https://www.npmjs.com/~nestjscore" target="_blank"><img src="https://img.shields.io/npm/dm/@nestjs/common.svg" alt="NPM Downloads" /></a>
<a href="https://circleci.com/gh/nestjs/nest" target="_blank"><img src="https://img.shields.io/circleci/build/github/nestjs/nest/master" alt="CircleCI" /></a>
<a href="https://coveralls.io/github/nestjs/nest?branch=master" target="_blank"><img src="https://coveralls.io/repos/github/nestjs/nest/badge.svg?branch=master#9" alt="Coverage" /></a>
<a href="https://discord.gg/G7Qnnhy" target="_blank"><img src="https://img.shields.io/badge/discord-online-brightgreen.svg" alt="Discord"/></a>
<a href="https://opencollective.com/nest#backer" target="_blank"><img src="https://opencollective.com/nest/backers/badge.svg" alt="Backers on Open Collective" /></a>
<a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://opencollective.com/nest/sponsors/badge.svg" alt="Sponsors on Open Collective" /></a>
<a href="https://paypal.me/kamilmysliwiec" target="_blank"><img src="https://img.shields.io/badge/Donate-PayPal-ff3f59.svg"/></a>
<a href="https://opencollective.com/nest#sponsor" target="_blank"><img src="https://img.shields.io/badge/Support%20us-Open%20Collective-41B883.svg" alt="Support us"></a>
<a href="https://twitter.com/nestframework" target="_blank"><img src="https://img.shields.io/twitter/follow/nestframework.svg?style=social&label=Follow"></a>
</p>

## Installation
```bash
$ npm install
```

## Running the app
```bash
# development
$ npm run start

# watch mode
$ npm run start:dev

# production mode
$ npm run start:prod
```

## Test
```bash
# unit tests
$ npm run test

# e2e tests
$ npm run test:e2e

# test coverage
$ npm run test:cov
```


---

# Welcome to Backend
This is a NestJS project with LOTS of plugins to support good programming.

## Navigating the files

### Files
- **API_SCHEMA.md**  
  Contains the schema documentation for the project's API.

- **check-versions.js**  
  A script to enforce the correct & consistent version of NodeJS.
  
- **jest.setup.js**  
  Jest configuration and setup script for testing.

- **nest-cli.json**  
  Configuration file for the Nest CLI.

- **package.json**  
  Lists project dependencies, scripts, and metadata. (for Node & NPM)

- **README.md**  
  Overview and documentation of the project.

- **tsconfig.json**  
  TypeScript compiler options and configuration for the project.

- **package-lock.json**  
  Records the exact version of each installed package to ensure consistent installs.

- **tsconfig.build.json**  
  TypeScript configuration for the build process.

- **webpack-hmr.config.js**  
  Webpack configuration for Hot Module Replacement (HMR).

### Directories

- **archive**  
  Archived files & folders.
  
- **coverage**  
  Contains code coverage reports generated by Jest.

- **dist**  
  Compiled output files from the TypeScript source code.
  
- **documentation**  
  Auto-generated documentation for the project.
  
- **jest_mocking**  
  Contains mock files for Jest testing.

- **node_modules**  
  Dependency modules & addons installed by npm.

- **prisma**  
  Contains Prisma-related files, including schema and migration configurations.

- **src**  
  Source code of the application.

- **test**  
  Contains unit and integration tests for the application.
  
- **tools**  
  Extra tools & scripts for development.

- **uploads**  
  Directory for uploaded files.

## Source files
### Files

- **app.controller.spec.ts**  
  Unit tests for the `AppController` class.

- **app.service.ts**  
  Contains the business logic for the `AppService` class.

- **app.controller.ts**  
  The main controller handling incoming requests and returning responses.

- **app.module.ts**  
  Main application module that imports and configures other modules and providers.

- **main.ts**  
  The entry point of the NestJS application, bootstrapping the app.

### Directories

- **auth**  
  Handles authentication-related functionality, including login, registration, and token management.

- **bull-config**  
  Configuration files for Bull queue management.

- **bull-board**  
  Provides a UI for monitoring Bull queues.

- **chat**  
  Manages chat functionalities, including messaging and chat rooms.

- **common**  
  Contains shared utilities, guards, and pipes used throughout the application.

- **config**  
  Configuration files and settings for different environments.

- **modules**  
  Contains the core modules of the application, organizing related features and components.

- **s3**  
  Integrations and services related to Amazon S3 for file storage.

- **spotify**  
  Integration with the Spotify API for handling music-related features. (Excluding Spotify Auth)

- **tasks**  
  Scheduled tasks and background jobs for the application.

## How things work in NestJS
NestJS is built for an MVC architecture out of the box.
It merges the backend and API layers into 1 server-side app.

### Controllers
All endpoints / accessible paths to the application are defined in controllers.
Eg. `GET /user` and `POST /user/settings` could be in `UserController.ts`


### Services
Controllers are best left to handle how input and output data flows through the application. Thus, the complex logic expected from the endpoints & paths are best kept in services.

Business logic, such as checking if data is valid, managing complex operations on the data, database (and other external service) interactions, etc are stored in services.

Eg, `getUserInfo()` or `getUserRooms()` would be stored in `UserService.ts`

### Modules
Given that controllers and services can be closely related and can also make use of other services, dependencies for them are stored in modules.

Modules in NestJS are used to organize the application into cohesive blocks of related functionality. They encapsulate controllers, providers (services), and other configuration elements, ensuring modularity and maintainability of the codebase.

Eg, `UserModule.ts` would link `UserService` and `UserController` together as well as manage their imports (shared or otherwise), make `UserController`'s  endpoints to the rest of the application, allow for `UserService` to be able to be imported by other services/controllers, etc

#### Defining a Module
A module definition looks like this:
```typescript
@Module({
	imports: [PrismaModule],
	controllers: [UsersController],
	providers: [
		UsersService,
		PrismaService,
		DtoGenService,
		DbUtilsService,
		AuthService,
	],
	exports: [UsersService],
})
export class UsersModule {}
```

1. **Imports**
When a module uses another module's functionalities and dependencies, they should be imported. This establishes a hierarchical relationship where modules can depend on one another.

Anything that's external to the module must have its accompanying Module imported here.

2. **Controllers**
By default, all modules are linked to the main `AppModule` and thus, any controllers added to the `controllers` list of a module makes them accessible when the server app is running.

3. **Providers**
Any services created and used within the module should be added to the providers list as that they can be injected into controllers or other services for loose coupling.

This is for any services & providers defined internally / within the module. No external services (eg. `PrismaService`) should be placed here.

4. **Exports**
Any components (like services/providers) used within the module and that should be made available for use in other modules should be added to the exports array. This allows them to be included in another module's providers without being concerned about the service's module structure.

## Coding Standards
(TBA)